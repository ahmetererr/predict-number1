{"ast":null,"code":"var _jsxFileName = \"/Users/ahmet/predict-number1/web/src/components/DrawingCanvas.tsx\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect, useState } from 'react';\nimport axios from 'axios';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst DrawingCanvas = ({\n  mode,\n  onPrediction,\n  requestedDigit\n}) => {\n  _s();\n  const canvasRef = useRef(null);\n  const [isDrawing, setIsDrawing] = useState(false);\n  const [context, setContext] = useState(null);\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (canvas) {\n      const ctx = canvas.getContext('2d');\n      if (ctx) {\n        ctx.strokeStyle = 'white';\n        ctx.lineWidth = 10;\n        ctx.lineCap = 'round';\n        ctx.lineJoin = 'round';\n        setContext(ctx);\n      }\n    }\n  }, []);\n  const startDrawing = e => {\n    setIsDrawing(true);\n    const {\n      offsetX,\n      offsetY\n    } = getCoordinates(e);\n    context === null || context === void 0 ? void 0 : context.beginPath();\n    context === null || context === void 0 ? void 0 : context.moveTo(offsetX, offsetY);\n  };\n  const draw = e => {\n    if (!isDrawing) return;\n    const {\n      offsetX,\n      offsetY\n    } = getCoordinates(e);\n    context === null || context === void 0 ? void 0 : context.lineTo(offsetX, offsetY);\n    context === null || context === void 0 ? void 0 : context.stroke();\n  };\n  const stopDrawing = () => {\n    setIsDrawing(false);\n  };\n  const getCoordinates = e => {\n    if ('touches' in e) {\n      var _canvasRef$current;\n      const rect = (_canvasRef$current = canvasRef.current) === null || _canvasRef$current === void 0 ? void 0 : _canvasRef$current.getBoundingClientRect();\n      return {\n        offsetX: e.touches[0].clientX - ((rect === null || rect === void 0 ? void 0 : rect.left) || 0),\n        offsetY: e.touches[0].clientY - ((rect === null || rect === void 0 ? void 0 : rect.top) || 0)\n      };\n    }\n    return {\n      offsetX: e.nativeEvent.offsetX,\n      offsetY: e.nativeEvent.offsetY\n    };\n  };\n  const clearCanvas = () => {\n    if (context && canvasRef.current) {\n      context.clearRect(0, 0, canvasRef.current.width, canvasRef.current.height);\n    }\n  };\n  const handleSubmit = async () => {\n    if (!canvasRef.current) return;\n    const imageData = canvasRef.current.toDataURL('image/png');\n    const blob = await (await fetch(imageData)).blob();\n    const formData = new FormData();\n    formData.append('image', blob, 'digit.png');\n    try {\n      const endpoint = mode === 'test' ? '/predict' : '/train';\n      if (mode === 'train' && requestedDigit !== null) {\n        formData.append('digit', requestedDigit.toString());\n      }\n      const response = await axios.post(`http://localhost:8000${endpoint}`, formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      });\n      if (mode === 'test') {\n        onPrediction(response.data.predicted_digit, response.data.confidence);\n      } else {\n        clearCanvas();\n        // Trigger new random digit request\n      }\n    } catch (error) {\n      console.error('Error submitting drawing:', error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex flex-col items-center gap-4\",\n    children: [/*#__PURE__*/_jsxDEV(\"canvas\", {\n      ref: canvasRef,\n      width: 280,\n      height: 280,\n      className: \"border-2 border-gray-300 dark:border-gray-600 bg-black rounded-lg touch-none\",\n      onMouseDown: startDrawing,\n      onMouseMove: draw,\n      onMouseUp: stopDrawing,\n      onMouseLeave: stopDrawing,\n      onTouchStart: startDrawing,\n      onTouchMove: draw,\n      onTouchEnd: stopDrawing\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex gap-4\",\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: clearCanvas,\n        className: \"px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded\",\n        children: \"Clear\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleSubmit,\n        className: \"px-4 py-2 bg-blue-600 text-white rounded\",\n        children: mode === 'train' ? 'Submit Training' : 'Test Prediction'\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 103,\n    columnNumber: 5\n  }, this);\n};\n_s(DrawingCanvas, \"KTUhFOgO2vZq198L7OfYQwJ83Sc=\");\n_c = DrawingCanvas;\nexport default DrawingCanvas;\nvar _c;\n$RefreshReg$(_c, \"DrawingCanvas\");","map":{"version":3,"names":["React","useRef","useEffect","useState","axios","jsxDEV","_jsxDEV","DrawingCanvas","mode","onPrediction","requestedDigit","_s","canvasRef","isDrawing","setIsDrawing","context","setContext","canvas","current","ctx","getContext","strokeStyle","lineWidth","lineCap","lineJoin","startDrawing","e","offsetX","offsetY","getCoordinates","beginPath","moveTo","draw","lineTo","stroke","stopDrawing","_canvasRef$current","rect","getBoundingClientRect","touches","clientX","left","clientY","top","nativeEvent","clearCanvas","clearRect","width","height","handleSubmit","imageData","toDataURL","blob","fetch","formData","FormData","append","endpoint","toString","response","post","headers","data","predicted_digit","confidence","error","console","className","children","ref","onMouseDown","onMouseMove","onMouseUp","onMouseLeave","onTouchStart","onTouchMove","onTouchEnd","fileName","_jsxFileName","lineNumber","columnNumber","onClick","_c","$RefreshReg$"],"sources":["/Users/ahmet/predict-number1/web/src/components/DrawingCanvas.tsx"],"sourcesContent":["import React, { useRef, useEffect, useState } from 'react';\nimport axios from 'axios';\n\ninterface DrawingCanvasProps {\n  mode: 'train' | 'test';\n  onPrediction: (digit: number, confidence: number) => void;\n  requestedDigit: number | null;\n}\n\nconst DrawingCanvas: React.FC<DrawingCanvasProps> = ({\n  mode,\n  onPrediction,\n  requestedDigit,\n}) => {\n  const canvasRef = useRef<HTMLCanvasElement>(null);\n  const [isDrawing, setIsDrawing] = useState(false);\n  const [context, setContext] = useState<CanvasRenderingContext2D | null>(null);\n\n  useEffect(() => {\n    const canvas = canvasRef.current;\n    if (canvas) {\n      const ctx = canvas.getContext('2d');\n      if (ctx) {\n        ctx.strokeStyle = 'white';\n        ctx.lineWidth = 10;\n        ctx.lineCap = 'round';\n        ctx.lineJoin = 'round';\n        setContext(ctx);\n      }\n    }\n  }, []);\n\n  const startDrawing = (e: React.MouseEvent<HTMLCanvasElement> | React.TouchEvent<HTMLCanvasElement>) => {\n    setIsDrawing(true);\n    const { offsetX, offsetY } = getCoordinates(e);\n    context?.beginPath();\n    context?.moveTo(offsetX, offsetY);\n  };\n\n  const draw = (e: React.MouseEvent<HTMLCanvasElement> | React.TouchEvent<HTMLCanvasElement>) => {\n    if (!isDrawing) return;\n    const { offsetX, offsetY } = getCoordinates(e);\n    context?.lineTo(offsetX, offsetY);\n    context?.stroke();\n  };\n\n  const stopDrawing = () => {\n    setIsDrawing(false);\n  };\n\n  const getCoordinates = (e: React.MouseEvent<HTMLCanvasElement> | React.TouchEvent<HTMLCanvasElement>) => {\n    if ('touches' in e) {\n      const rect = canvasRef.current?.getBoundingClientRect();\n      return {\n        offsetX: e.touches[0].clientX - (rect?.left || 0),\n        offsetY: e.touches[0].clientY - (rect?.top || 0),\n      };\n    }\n    return {\n      offsetX: e.nativeEvent.offsetX,\n      offsetY: e.nativeEvent.offsetY,\n    };\n  };\n\n  const clearCanvas = () => {\n    if (context && canvasRef.current) {\n      context.clearRect(0, 0, canvasRef.current.width, canvasRef.current.height);\n    }\n  };\n\n  const handleSubmit = async () => {\n    if (!canvasRef.current) return;\n\n    const imageData = canvasRef.current.toDataURL('image/png');\n    const blob = await (await fetch(imageData)).blob();\n    const formData = new FormData();\n    formData.append('image', blob, 'digit.png');\n    \n    try {\n      const endpoint = mode === 'test' ? '/predict' : '/train';\n      if (mode === 'train' && requestedDigit !== null) {\n        formData.append('digit', requestedDigit.toString());\n      }\n\n      const response = await axios.post(`http://localhost:8000${endpoint}`, formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data',\n        },\n      });\n\n      if (mode === 'test') {\n        onPrediction(response.data.predicted_digit, response.data.confidence);\n      } else {\n        clearCanvas();\n        // Trigger new random digit request\n      }\n    } catch (error) {\n      console.error('Error submitting drawing:', error);\n    }\n  };\n\n  return (\n    <div className=\"flex flex-col items-center gap-4\">\n      <canvas\n        ref={canvasRef}\n        width={280}\n        height={280}\n        className=\"border-2 border-gray-300 dark:border-gray-600 bg-black rounded-lg touch-none\"\n        onMouseDown={startDrawing}\n        onMouseMove={draw}\n        onMouseUp={stopDrawing}\n        onMouseLeave={stopDrawing}\n        onTouchStart={startDrawing}\n        onTouchMove={draw}\n        onTouchEnd={stopDrawing}\n      />\n      <div className=\"flex gap-4\">\n        <button\n          onClick={clearCanvas}\n          className=\"px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded\"\n        >\n          Clear\n        </button>\n        <button\n          onClick={handleSubmit}\n          className=\"px-4 py-2 bg-blue-600 text-white rounded\"\n        >\n          {mode === 'train' ? 'Submit Training' : 'Test Prediction'}\n        </button>\n      </div>\n    </div>\n  );\n};\n\nexport default DrawingCanvas; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}